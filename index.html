<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Template B — Netflix Style</title>
<style>
  :root{
    --bg:#181818; --panel:#141414; --fg:#fff; --muted:#bdbdbd; --accent:#e50914;
  }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:var(--fg);font:16px/1.5 system-ui,Segoe UI,Roboto,Arial,sans-serif}
  header{
    position:sticky; top:0; z-index:10; background:var(--panel);
    display:flex; align-items:center; justify-content:space-between; gap:12px;
    padding:14px 22px; border-bottom:1px solid #222;
  }
  .brand{display:flex;align-items:center;gap:12px;font-weight:800;letter-spacing:.2px}
  .brand svg{width:26px;height:26px;color:var(--accent)}
  .controls{display:flex;gap:10px;flex-wrap:wrap}
  .chip, select{
    background:#2a2a2a; color:#fff; border:0; border-radius:999px; padding:10px 14px; cursor:pointer; font-weight:600;
  }
  .chip.active{background:var(--accent)}
  main{padding:22px}
  h2{margin:0 0 12px 4px; font-size:22px}
  .row-wrap{overflow:hidden}
  .row{
    display:flex; gap:12px; overflow-x:auto; padding:6px 4px 12px; scroll-behavior:smooth;
  }
  .row::-webkit-scrollbar{height:8px} .row::-webkit-scrollbar-thumb{background:#444;border-radius:10px}
  .card{flex:0 0 auto; width:168px; background:#0f0f0f; border-radius:10px; overflow:hidden; cursor:pointer;
        transition:transform .2s ease, box-shadow .2s ease; border:1px solid #222}
  .card:hover{transform:translateY(-2px); box-shadow:0 10px 30px rgba(0,0,0,.35)}
  .card img{width:100%; height:auto; display:block}
  .meta{padding:8px 10px}
  .title{font-size:14px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis}
  .sub{font-size:12px; color:var(--muted)}
  .status{margin:10px 6px; color:var(--muted)}
  /* modal */
  .modal{position:fixed; inset:0; display:none; place-items:center; background:rgba(0,0,0,.6)}
  .modal.open{display:grid}
  .sheet{max-width:880px; width:min(92vw,880px); background:#111; border:1px solid #222; border-radius:16px; overflow:hidden}
  .sheet-wrap{display:grid; grid-template-columns:280px 1fr; gap:16px; padding:16px}
  .sheet img{width:100%; border-radius:10px}
  .sheet h3{margin:0 0 6px}
  .sheet .overview{color:#d0d0d0; font-size:14px}
  .btn{
    background:var(--accent); color:#fff; border:0; border-radius:999px; padding:10px 16px; cursor:pointer; font-weight:700;
  }
  .btn.secondary{background:#2a2a2a}
  .sheet-actions{display:flex; gap:10px; margin-top:12px}
  @media (max-width:720px){
    .sheet-wrap{grid-template-columns:1fr}
  }
</style>
</head>
<body>

<header>
  <div class="brand">
    <svg viewBox="0 0 24 24" fill="currentColor"><path d="M8 5v14l11-7z"/></svg>
    <span><H1>Carango Tv</H1></span>
  </div>

  <div class="controls">
    <button class="chip active" id="tabMovie" onclick="switchType('movie')">Movies</button>
    <button class="chip" id="tabTV" onclick="switchType('tv')">TV Shows</button>

    <select id="timeSelect" onchange="reload()">
      <option value="day">Today</option>
      <option value="week">This Week</option>
    </select>
  </div>
</header>

<main>
  <h2 id="sectionTitle">Trending Movies</h2>
  <div class="status" id="status"></div>
  <div class="row-wrap">
    <div id="contentRow" class="row"></div>
  </div>
</main>

<!-- Detail Modal -->
<div class="modal" id="modal">
  <div class="sheet">
    <div class="sheet-wrap">
      <img id="mPoster" alt="Poster">
      <div>
        <h3 id="mTitle"></h3>
        <div class="sub" id="mMeta"></div>
        <p class="overview" id="mOverview"></p>
        <div class="sheet-actions">
          <button class="btn" id="playBtn">▶ Play</button>
          <button class="btn secondary" onclick="closeModal()">Close</button>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  // ====== CONFIG ======
  const TMDB_API_KEY = "915f1289f9c31479b780789c30ae6b2b";  // <-- replace
  const IMG = "https://image.tmdb.org/t/p/w300";

  // ====== STATE ======
  let currentType = "movie"; // 'movie' | 'tv'
  let cached = [];           // last fetched results

  // ====== INIT ======
  document.addEventListener("DOMContentLoaded", reload);

  // ====== UI SWITCHES ======
  function switchType(t){
    currentType = t;
    document.getElementById('tabMovie').classList.toggle('active', t==='movie');
    document.getElementById('tabTV').classList.toggle('active', t==='tv');
    reload();
  }
  function reload(){ loadTrending(currentType, document.getElementById('timeSelect').value); }

  // ====== FETCH TRENDING ======
  async function loadTrending(type="movie", time="day"){
    const title = type==='movie' ? "Trending Movies" : "Trending TV Shows";
    document.getElementById("sectionTitle").textContent = title;
    setStatus("Loading…");

    try{
      const url = `https://api.themoviedb.org/3/trending/${type}/${time}?api_key=${TMDB_API_KEY}`;
      const res = await fetch(url);
      if(!res.ok) throw new Error(res.status+" "+res.statusText);
      const data = await res.json();
      cached = data.results || [];
      renderRow(cached, type);
      setStatus("");
    }catch(err){
      console.error(err);
      setStatus("Sorry, something went wrong. Check your TMDB key or network.");
    }
  }

  function setStatus(msg){ document.getElementById('status').textContent = msg || ""; }

  // ====== RENDER CARDS ======
  function renderRow(items, type){
    const row = document.getElementById("contentRow");
    row.innerHTML = "";
    items.forEach(item=>{
      const title = item.title || item.name || "Untitled";
      const rating = (item.vote_average || 0).toFixed(1);
      const poster = item.poster_path ? IMG + item.poster_path : "https://via.placeholder.com/300x450?text=No+Image";
      const card = document.createElement("div");
      card.className = "card";
      card.innerHTML = `
        <img src="${poster}" loading="lazy" alt="${title}">
        <div class="meta">
          <div class="title">${title}</div>
          <div class="sub">⭐ ${rating}</div>
        </div>`;
      card.onclick = () => openModal(item, type);
      row.appendChild(card);
    });
  }

  // ====== MODAL ======
  function openModal(item, type){
    const poster = item.poster_path ? IMG + item.poster_path : "https://via.placeholder.com/300x450?text=No+Image";
    document.getElementById('mPoster').src = poster;
    document.getElementById('mPoster').alt = item.title || item.name || "Poster";
    document.getElementById('mTitle').textContent = item.title || item.name || "Untitled";
    const date = item.release_date || item.first_air_date || "—";
    document.getElementById('mMeta').textContent = `${type.toUpperCase()} • ${date} • ⭐ ${(item.vote_average||0).toFixed(1)}`;
    document.getElementById('mOverview').textContent = item.overview || "No overview available.";

    const id = item.id;
    const playBtn = document.getElementById('playBtn');
    playBtn.onclick = () => {
      if(type === 'movie'){
        // Play movie by TMDB id
        window.location.href = `https://vidsrc.xyz/embed/movie?tmdb=${id}`;
      }else{
        // Ask for season / episode quickly
        const s = prompt("Season number?", "1");
        if(s === null) return;
        const e = prompt("Episode number?", "1");
        if(e === null) return;
        window.location.href = `https://vidsrc.xyz/embed/tv?tmdb=${id}&season=${encodeURIComponent(s)}&episode=${encodeURIComponent(e)}`;
      }
    };

    document.getElementById('modal').classList.add('open');
  }
  function closeModal(){ document.getElementById('modal').classList.remove('open'); }
  // Close on background click
  document.getElementById('modal').addEventListener('click', (e)=>{
    if(e.target.id === 'modal') closeModal();
  });
</script>
</body>
</html>
